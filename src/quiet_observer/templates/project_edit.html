{% extends "base.html" %}
{% block title %}Edit {{ project.name }} – Quiet Observer{% endblock %}
{% block content %}
<div class="form-page">
  <a href="/projects/{{ project.id }}" class="text-muted">← {{ project.name }}</a>
  <h1 style="margin-top:0.5rem">Edit Project</h1>
  {% if error %}
  <div class="alert alert-error">{{ error }}</div>
  {% endif %}
  <form method="post" action="/projects/{{ project.id }}/edit" class="form">
    <div class="form-group">
      <label for="name">Project name</label>
      <input type="text" id="name" name="name" required
             value="{{ form.name if form else project.name }}">
    </div>
    <div class="form-group">
      <label for="youtube_url">YouTube URL</label>
      <input type="url" id="youtube_url" name="youtube_url" required
             value="{{ form.youtube_url if form else project.youtube_url }}">
    </div>
    <div class="form-row">
      <div class="form-group">
        <label for="sample_interval_seconds">Sample interval (seconds)</label>
        <input type="number" id="sample_interval_seconds" name="sample_interval_seconds"
               min="5" max="3600"
               value="{{ form.sample_interval_seconds if form else project.sample_interval_seconds }}">
      </div>
      <div class="form-group">
        <label for="inference_interval_seconds">Inference interval (seconds)</label>
        <input type="number" id="inference_interval_seconds" name="inference_interval_seconds"
               min="5" max="3600"
               value="{{ form.inference_interval_seconds if form else project.inference_interval_seconds }}">
      </div>
    </div>
    <h3 style="margin-top:1.5rem">Inference sampling thresholds</h3>
    <p class="text-muted" style="margin-bottom:1rem;font-size:0.9rem">
      During inference, frames with any detection confidence between low and high thresholds
      are sampled for labeling. Detections below the low threshold are treated as noise.
    </p>
    <div class="form-row">
      <div class="form-group">
        <label for="auto_sample_interval_seconds">Auto-sample interval (seconds)</label>
        <input type="number" id="auto_sample_interval_seconds" name="auto_sample_interval_seconds"
               min="10" max="86400"
               value="{{ form.auto_sample_interval_seconds if form else project.auto_sample_interval_seconds or 600 }}">
      </div>
      <div class="form-group">
        <label for="low_confidence_threshold">Low confidence threshold</label>
        <input type="number" id="low_confidence_threshold" name="low_confidence_threshold"
               min="0" max="1" step="0.05"
               value="{{ form.low_confidence_threshold if form else project.low_confidence_threshold if project.low_confidence_threshold is not none else 0.3 }}">
      </div>
      <div class="form-group">
        <label for="high_confidence_threshold">High confidence threshold</label>
        <input type="number" id="high_confidence_threshold" name="high_confidence_threshold"
               min="0" max="1" step="0.05"
               value="{{ form.high_confidence_threshold if form else project.high_confidence_threshold if project.high_confidence_threshold is not none else 0.7 }}">
      </div>
    </div>
    <div class="form-actions">
      <a href="/projects/{{ project.id }}" class="btn">Cancel</a>
      <button type="submit" class="btn btn-primary">Save Changes</button>
    </div>
  </form>
</div>
{% endblock %}
